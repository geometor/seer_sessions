
## train_1

**input:**
```
6 7 1 1 1 1 1 1 1 1 1 1 1 7 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 1 1 1 1 1 1 1 1 1 1 1 4 7 4
6 7 7 7 7 7 7 7 7 7 7 7 7 4 7 4
6 7 4 4 4 4 4 4 4 4 4 4 4 4 7 4
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 4
6 7 4 4 4 4 4 4 4 4 4 4 4 4 4 4
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 0 0 0 0 0 0 0 0 0 0 0 0 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 9
6 7 7 9 9 9 9 9 9 9 9 9 9 9 7 9
6 7 7 7 7 7 7 7 7 7 7 7 7 9 7 9
6 7 7 8 8 8 8 8 8 8 8 8 8 8 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 3 3 3 3 3 3 3 7 7
```


**output:**
```
6 7 1 1 1 1 1 1 1 1 1 1 1 7 6 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 6
6 7 1 1 1 1 1 1 1 1 1 1 1 4 7 4
6 7 7 7 7 7 7 7 7 7 7 7 7 4 7 4
6 7 4 4 4 4 4 4 4 4 4 4 4 4 7 4
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 4
6 7 4 4 4 4 4 4 4 4 4 4 4 4 4 4
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 0 0 0 0 0 0 0 0 0 0 0 0 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 9
6 7 7 9 9 9 9 9 9 9 9 9 9 9 7 9
6 7 7 7 7 7 7 7 7 7 7 7 7 9 7 9
6 7 7 8 8 8 8 8 8 8 8 8 8 8 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 3 3 3 3 3 3 3 6 7
```


## train_2

**input:**
```
6 7 3 3 3 3 3 3 3 3 3 3 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 8 8 8 8 8 8 8 8 8 8 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 1 1 1 1 1 1 1 1 1 1 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 1 1 1 1 1 1 1 1 1 1 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 5 5 5 5 5 5 5 5 5 5 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 0 0 0 0 0 0 0 0 0 0 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 0 0 0 0 0 0 0 0 0 0 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 9 9 9 9 9 9 9 9 9 9 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 3 3 3 3 3 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 3 3 3 3 3 7 7
```


**output:**
```
6 7 3 3 3 3 3 3 3 3 3 3 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 8 8 8 8 8 8 8 8 8 8 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 1 1 1 1 1 1 1 1 1 1 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 6
6 7 1 1 1 1 1 1 1 1 1 1 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 5 5 5 5 5 5 5 5 5 5 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 0 0 0 0 0 0 0 0 0 0 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 6
6 7 0 0 0 0 0 0 0 0 0 0 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 9 9 9 9 9 9 9 9 9 9 7 7
6 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 3 3 3 3 3 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 6
6 7 3 3 3 3 3 3 3 3 3 3 7 7
```


## train_3

**input:**
```
6 7 4 4 4 4 4 4 4 4 4 4 4 4 4 4
6 7 7 7 7 7 7 7 7 4 7 7 7 7 7 4
6 7 4 4 4 4 4 4 7 4 7 4 4 4 7 4
6 7 7 7 7 7 7 4 7 4 7 4 7 4 7 4
6 7 2 2 2 2 2 2 7 7 7 7 7 4 7 4
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 2 2 2 2 2 2 7 5 7 5 7 9 7 0
6 7 7 7 7 7 7 7 7 5 7 5 7 9 7 0
6 7 5 5 5 5 5 5 5 5 7 5 7 9 7 0
6 7 7 7 7 7 7 7 7 7 7 5 7 9 7 0
6 7 5 5 5 5 5 5 5 5 5 5 7 9 7 0
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
6 7 3 3 3 3 3 7 7 7 3 3 3 3 3 3
6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 3
6 7 3 3 3 3 3 7 7 7 3 3 3 3 7 3
6 7 7 7 7 7 7 7 7 7 7 7 7 3 7 3
6 7 0 0 0 0 0 0 0 0 0 0 0 0 7 7
```


**output:**
```
6 7 4 4 4 4 4 4 4 4 4 4 4 4 4 4
7 7 7 7 7 7 7 7 7 4 7 7 7 7 7 4
6 7 4 4 4 4 4 4 7 4 7 4 4 4 7 4
6 7 7 7 7 7 7 4 7 4 7 4 7 4 7 4
6 7 2 2 2 2 2 2 7 7 7 7 7 4 7 4
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 6
6 7 2 2 2 2 2 2 7 5 7 5 7 9 7 0
6 7 7 7 7 7 7 7 6 5 7 5 7 9 7 0
6 7 5 5 5 5 5 5 5 5 7 5 7 9 7 0
7 7 7 7 7 7 7 7 7 7 7 5 7 9 7 0
6 7 5 5 5 5 5 5 5 5 5 5 7 9 7 0
6 7 7 7 7 7 7 7 7 7 7 7 7 7 6 7
6 7 3 3 3 3 3 7 7 7 3 3 3 3 3 3
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 3
6 7 3 3 3 3 3 7 7 7 3 3 3 3 7 3
6 7 7 7 7 7 7 7 7 7 7 7 7 3 7 3
6 7 0 0 0 0 0 0 0 0 0 0 0 0 6 7
```

*   **Perception:**
    *   The input and output grids have the same dimensions in all examples.
    *   The grids primarily consist of an orange (7) background color.
    *   A vertical magenta (6) line is consistently present in the first column (index 0) of the input grids, though not necessarily in every row.
    *   Various horizontal lines or segments composed of colors other than magenta or orange appear in certain rows, typically starting from column index 2. These lines are separated by rows that are predominantly orange.
    *   The core transformation involves modifying pixels in rows that contain a magenta (6) pixel in the first column.
    *   Two distinct transformation patterns emerge based on the content of these magenta-starting rows:
        1.  If a row starts with magenta (6) and the rest of the row consists *only* of orange (7) pixels, the magenta pixel at the beginning moves to the end of the row, and the original starting position becomes orange.
        2.  If a row starts with magenta (6) but contains colors *other than* orange elsewhere in the row, the *rightmost* orange (7) pixel within that row changes to magenta (6). The initial magenta pixel remains unchanged in this case.
    *   Rows that do not start with magenta (6) remain unchanged between input and output.

*   **Facts:**
    
```yaml
    grid_properties:
      - dimension_preservation: Input and output grids have identical height and width.
    colors:
      - background: orange (7)
      - key_color: magenta (6)
      - other_colors: blue(1), red(2), green(3), yellow(4), gray(5), magenta(6), orange(7), azure(8), maroon(9), white(0)
    objects:
      - type: vertical_line
        color: magenta (6)
        location: column 0 (input only, conditional)
      - type: horizontal_lines
        color: various (excluding magenta initially)
        location: rows separated by orange rows
      - type: background_rows
        color: orange (7)
        location: rows separating horizontal lines or filling space
    rules:
      - name: process_magenta_rows
        target: rows where grid[row, 0] == 6
        conditions:
          - name: all_orange_row
            condition: all pixels from grid[row, 1] to grid[row, width-1] are orange (7)
            action:
              - change pixel at [row, 0] from magenta (6) to orange (7)
              - change pixel at [row, width-1] from orange (7) to magenta (6)
          - name: mixed_color_row
            condition: at least one pixel from grid[row, 1] to grid[row, width-1] is not orange (7)
            action:
              - find the largest column index 'c' such that grid[row, c] == orange (7)
              - change pixel at [row, c] from orange (7) to magenta (6)
      - name: process_other_rows
        target: rows where grid[row, 0] != 6
        action:
          - keep the row unchanged
    ```


*   **Natural Language Program:**
    1.  Initialize the output grid as a copy of the input grid.
    2.  Iterate through each row of the input grid.
    3.  For the current row, check if the pixel in the first column (column 0) is magenta (6).
    4.  **If** the pixel in the first column is magenta (6):
        a.  Check if all pixels in the row from the second column (column 1) to the last column are orange (7).
        b.  **If** all subsequent pixels are orange (7):
            i.  Change the pixel in the first column (column 0) of the output grid for this row to orange (7).
            ii. Change the pixel in the *last* column of the output grid for this row to magenta (6).
        c.  **Else** (if there are non-orange pixels after the first column):
            i.  Find the column index of the *rightmost* orange (7) pixel in this row of the input grid.
            ii. If an orange pixel is found, change the pixel at that row and rightmost orange column index in the output grid to magenta (6). (The initial magenta at column 0 remains).
    5.  **Else** (if the pixel in the first column is not magenta):
        a.  Keep the row in the output grid exactly as it is in the input grid (no changes needed as it was copied initially).
    6.  Return the modified output grid.
