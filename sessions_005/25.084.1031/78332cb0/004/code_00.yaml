- task: Reassemble panels defined by separators based on separator type.
- objects:
    - input_grid: The initial 2D array.
    - output_grid: The transformed 2D array.
    - separators: Lines (rows or columns) consisting entirely of magenta pixels (color 6).
        - horizontal_separator: A row of magenta pixels.
        - vertical_separator: A column of magenta pixels.
    - panels: Rectangular subgrids of the input_grid defined by the boundaries of the grid and the separators. They do not contain any separator pixels.
        - properties:
            - content: The pattern of non-magenta pixels within the panel.
            - original_location: Top-left coordinate (row, col) in the input grid.
            - grid_order_index: The index based on a top-to-bottom, left-to-right scan (0-indexed).
- actions:
    - identify_separators: Find all horizontal and vertical separator lines.
    - extract_panels: Isolate the subgrids (panels) delimited by separators or grid edges. Keep track of their original location.
    - determine_arrangement:
        - If only horizontal separators exist: Arrange panels horizontally.
        - If vertical separators exist (regardless of horizontal ones): Arrange panels vertically.
        - If no separators exist: The grid remains unchanged.
    - determine_panel_order:
        - Calculate the base order by sorting extracted panels based on their original top-left coordinates (top-to-bottom, then left-to-right).
        - If arranging horizontally (H-only case): Reverse the base order.
        - If arranging vertically AND only vertical separators exist (V-only case): Use the base order.
        - If arranging vertically AND both horizontal and vertical separators exist (Both case): Use a specific permutation of the base order: [panel_0, panel_3, panel_1, panel_2] (assuming a 2x2 panel layout from base order indices 0, 1, 2, 3).
    - assemble_output:
        - If arranging vertically: Stack the ordered panels, inserting a single row of magenta pixels between each panel. The separator width matches the panel width.
        - If arranging horizontally: Concatenate the ordered panels side-by-side, inserting a single column of magenta pixels between each panel. The separator height matches the panel height.
        - If no separators were found: The output is identical to the input.