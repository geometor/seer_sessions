
## train_1

**input:**
```
0 0 0 0 0 0 0 0 2 2 0 0 0 2 0 0
2 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0
0 0 2 0 0 0 0 0 0 0 2 0 0 2 0 2
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0
0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0
0 0 2 0 0 0 0 0 0 0 2 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 3 2 2 3 0 3 2 3 0
2 0 0 0 0 0 0 3 3 3 3 0 3 2 3 0
0 0 0 0 0 0 0 0 0 0 0 0 3 3 3 0
0 0 0 0 0 0 0 0 2 0 0 0 0 0 3 3
0 0 2 0 0 0 0 0 0 0 2 0 0 2 3 2
0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 2
0 0 0 0 0 0 0 0 0 0 2 0 0 0 3 3
0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0
0 0 2 0 0 0 0 0 0 0 2 0 0 0 0 0
```


## train_2

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 2 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 3 3 3 0 0 0 0 0 0 0 0 0
0 0 2 0 0 0 3 2 3 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 3 2 3 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 3 3 3 0 0 0 0 2 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
```

*   **Perception:**
    *   The input grids contain white (0) background pixels and scattered red (2) pixels.
    *   The output grids retain the original red pixels but also introduce green (3) pixels.
    *   The green pixels appear only in the vicinity of *clusters* of red pixels, where a cluster consists of two or more red pixels that are adjacent either cardinally (up, down, left, right) or diagonally.
    *   Isolated red pixels (those with no red neighbors) do not cause any green pixels to appear around them and remain unchanged in the output.
    *   For each cluster of red pixels (size >= 2), a rectangular area is colored green. This area seems to be the bounding box encompassing the red pixels of the cluster *and* all their immediate neighbors (including diagonals).
    *   Within these green rectangular areas, the pixels that were originally red in the input remain red in the output.

*   **Facts:**
    
```yaml
    task_elements:
      - Input Grid:
          colors: [white, red]
          pixels:
            - white: 0 (background)
            - red: 2 (objects)
      - Output Grid:
          colors: [white, red, green]
          pixels:
            - white: 0 (background)
            - red: 2 (original objects, preserved)
            - green: 3 (newly colored areas)
    transformation:
      - Identify Objects: Find all red (2) pixels.
      - Define Clusters: Group red pixels into connected components (clusters) using 8-directional adjacency (cardinal + diagonal).
      - Filter Clusters: Select only clusters containing 2 or more red pixels.
      - Process Clusters:
          For each selected cluster:
            - Define Region: Determine the set of coordinates containing all red pixels in the cluster AND all their 8-directional neighbors.
            - Calculate Bounding Box: Find the minimum bounding box (min_row, min_col, max_row, max_col) enclosing all coordinates in the defined region.
            - Fill Area: Change the color of all pixels within the bounding box to green (3).
            - Restore Objects: Change the color of the pixels corresponding to the original red pixels (within the cluster) back to red (2).
      - Unchanged Elements:
          - White pixels outside the calculated bounding boxes remain white.
          - Isolated red pixels (clusters of size 1) remain red.
    relationships:
      - Adjacency: Defines how red pixels form clusters (8-directional).
      - Containment: Clusters and their neighbors define a region; a bounding box contains this region.
    ```


*   **Natural Language Program:**
    1.  Start with the input grid. Create a copy of it to serve as the output grid.
    2.  Identify all locations (coordinates) of red (2) pixels in the input grid.
    3.  Determine the connected components (clusters) of these red pixels, considering two pixels connected if they are adjacent horizontally, vertically, or diagonally.
    4.  Filter these clusters, keeping only those that contain two or more red pixels.
    5.  For each valid cluster (size >= 2):
        a.  Create a set of all coordinates occupied by the red pixels in this cluster.
        b.  Create a second set containing the coordinates of all 8 immediate neighbors (horizontal, vertical, diagonal) for every pixel in the cluster. Ensure coordinates stay within grid bounds.
        c.  Combine these two sets into a single set representing the 'region of interest' for this cluster.
        d.  Find the minimum and maximum row and column indices among all coordinates in the 'region of interest'. These define the bounding box for the cluster.
        e.  Iterate through every coordinate (row, column) within this bounding box (from min_row to max_row, min_col to max_col). Set the color of the pixel at this coordinate in the *output grid* to green (3).
        f.  After filling the bounding box with green, iterate through the original coordinates of the red pixels belonging to *this specific cluster*. For each such coordinate, set the color of the pixel at that coordinate in the *output grid* back to red (2).
    6.  After processing all valid clusters, the modified output grid is the final result. If no clusters of size 2 or more were found, the output grid will be identical to the input grid.
