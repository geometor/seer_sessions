def describe_grid(grid):
    grid = np.array(grid)
    rows, cols = grid.shape
    unique_values = np.unique(grid)
    value_counts = {val: np.count_nonzero(grid == val) for val in unique_values}
    red_positions = np.where(grid == 2)
    if len(red_positions[0]) > 0:
      red_rows, red_cols = red_positions
      red_bounds = {
          'min_row': int(np.min(red_rows)), 'max_row': int(np.max(red_rows)),
          'min_col': int(np.min(red_cols)), 'max_col': int(np.max(red_cols))
      }
    else:
      red_bounds = None
    

    return {
        'dimensions': (rows, cols),
        'unique_values': unique_values.tolist(),
        'value_counts': value_counts,
        'red_bounds': red_bounds
    }

task = {
    "train": [
        {
            "input": [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 2, 2, 2, 0, 0, 0, 0, 0],
                [0, 2, 2, 2, 0, 0, 0, 0, 0],
                [0, 2, 2, 2, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
            ],
            "output": [
                [5, 5, 5],
                [5, 5, 5],
                [5, 5, 5],
            ],
        },
        {
            "input": [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 2, 2],
                [0, 0, 0, 0, 0, 0, 0, 2, 2],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
            ],
            "output": [
                [5, 5],
                [5, 5],
            ],
        },
        {
            "input": [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 2],
                [0, 0, 0, 0, 0, 0, 0, 0, 2],
                [0, 0, 0, 0, 0, 0, 0, 0, 2],
            ],
            "output": [[5], [5], [5]],
        },
        {
            "input": [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0, 0, 0, 0],
                [0, 2, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
            ],
            "output": [[5], [5], [5]],
        },
        {
            "input": [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 2, 2, 2, 2],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
            ],
            "output": [[5, 5, 5, 5]],
        },
    ]
}

import numpy as np

results = []
for example in task['train']:
  results.append(
        {
            'input': describe_grid(example['input']),
            'output': describe_grid(example['output']),
            'predicted': describe_grid(transform(example['input']))
        }
  )
print(results)
