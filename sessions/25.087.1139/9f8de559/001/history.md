
## train_1

**input:**
```
9 9 9 9 9 9 9 9 9 9 9 9 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 6 7 7 5 5
9 9 7 7 7 7 7 7 7 6 7 7 5 5
9 9 7 7 7 7 7 7 7 6 7 7 5 5
5 5 7 7 7 7 7 7 7 6 7 7 5 5
5 5 7 7 7 7 7 7 7 2 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 8 5 5 8 8 8 8 8 8 8 8 8
```


**output:**
```
9 9 9 9 9 9 9 9 9 9 9 9 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 6 7 7 5 5
9 9 7 7 7 7 7 7 7 6 7 7 5 5
9 9 7 7 7 7 7 7 7 6 7 7 5 5
5 5 7 7 7 7 7 7 7 6 7 7 5 5
5 5 7 7 7 7 7 7 7 2 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 7 7 7 7 7 7 7 7 7 7 5 5
5 5 8 5 5 8 8 8 8 7 8 8 8 8
```


## train_2

**input:**
```
5 5 5 5 5 5 5 5 9 9 5 5 5 5
5 5 5 5 5 5 5 5 9 9 5 5 5 5
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 2 7 7 7 7 7 9 9 9
8 8 7 7 7 7 6 7 7 7 7 9 9 9
8 8 7 7 7 7 7 6 7 7 7 9 9 9
8 8 7 7 7 7 7 7 6 7 7 9 9 9
8 8 7 7 7 7 7 7 7 6 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 8 8 8
8 8 7 7 7 7 7 7 7 7 7 8 8 8
5 5 9 9 5 5 5 5 5 5 5 8 8 8
```


**output:**
```
5 5 5 5 5 5 5 5 9 9 5 5 5 5
5 5 5 7 5 5 5 5 9 9 5 5 5 5
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 2 7 7 7 7 7 9 9 9
8 8 7 7 7 7 6 7 7 7 7 9 9 9
8 8 7 7 7 7 7 6 7 7 7 9 9 9
8 8 7 7 7 7 7 7 6 7 7 9 9 9
8 8 7 7 7 7 7 7 7 6 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 9 9 9
8 8 7 7 7 7 7 7 7 7 7 8 8 8
8 8 7 7 7 7 7 7 7 7 7 8 8 8
5 5 9 9 5 5 5 5 5 5 5 8 8 8
```


## train_3

**input:**
```
9 9 9 9 9 9 5 5 9 9 9 9 9 9
9 9 9 9 9 9 5 5 9 9 9 9 9 9
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 2 6 6 6 6 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 8 8 8 8 8 9 8 8 8 8 8
9 9 9 8 8 8 8 8 9 8 8 8 8 8
```


**output:**
```
9 9 9 9 9 9 5 5 9 9 9 9 9 9
9 9 9 9 9 9 5 5 9 9 9 9 9 9
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 7 7 7 7 2 6 6 6 6 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 7 7 7 7 7 7 7 7 7 5 5
9 9 9 8 8 8 8 8 9 8 8 8 8 8
9 9 9 8 8 8 8 8 9 8 8 8 8 8
```


## train_4

**input:**
```
8 8 8 8 8 8 8 8 8 8 8 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 6 6 6 6 2 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 9 9 9
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
5 5 5 5 5 5 5 5 5 5 5 8 8 8
5 5 5 5 5 5 5 5 5 5 5 8 8 8
```


**output:**
```
8 8 8 8 8 8 8 8 8 8 8 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 6 6 6 6 2 7 7 7 7 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 9 9 9
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
9 7 7 7 7 7 7 7 7 7 7 8 8 8
5 5 5 5 5 5 5 5 5 5 5 8 8 8
5 5 5 5 5 5 5 5 5 5 5 8 8 8
```

*   **Perception of Task Elements**
    *   The input grids contain a prominent area of orange (7) pixels.
    *   Within or near the orange area, there is always a single red (2) pixel and one or more magenta (6) pixels.
    *   Other colors like gray (5), maroon (9), and azure (8) often form borders or appear as isolated pixels.
    *   The transformation involves changing the color of a single pixel in the grid.
    *   The location of the red pixel and the relative location of the magenta pixels appear crucial in determining which pixel changes and what its new color becomes.
    *   The magenta pixels seem to indicate a direction relative to the red pixel.
    *   The transformation acts along a line (horizontal, vertical, or diagonal) extending from the red pixel in the direction *opposite* to the one indicated by the magenta pixels.
    *   The rule for selecting the target pixel and its final color depends on whether the indicated direction is cardinal (horizontal/vertical) or diagonal.

*   **YAML Facts**
    
```yaml
    Grid:
      Properties:
        - Width: Variable
        - Height: Variable
        - Pixels: Colored integer values (0-9)
    Objects:
      - Red_Pixel:
          Count: 1
          Color: 2 (Red)
          Role: Origin point for transformation logic
      - Magenta_Pixels:
          Count: 1 or more
          Color: 6 (Magenta)
          Role: Define a direction relative to the Red_Pixel
          Property: Position relative to Red_Pixel (closest magenta is key)
      - Orange_Pixels:
          Color: 7 (Orange)
          Role: Background/medium through which the transformation effect propagates or is blocked.
      - Target_Pixel:
          Role: The single pixel whose color is changed by the transformation.
          Identification: Determined by ray tracing from Red_Pixel.
          Properties:
            - Initial_Color: Varies
            - Final_Color: Depends on Initial_Color and trace direction type (Orange or Gray)
    Relationships:
      - Red_Pixel_Magenta_Direction: The vector from the Red_Pixel to the *closest* Magenta_Pixel defines a primary direction (Horizontal, Vertical, or Diagonal).
      - Opposite_Direction: The transformation operates in the direction opposite to the Red_Pixel_Magenta_Direction.
      - Ray_Trace: A path is traced from the Red_Pixel in the Opposite_Direction.
    Actions:
      - Locate: Find the coordinates of the Red_Pixel.
      - Find_Closest: Identify the Magenta_Pixel nearest to the Red_Pixel.
      - Determine_Direction: Calculate the vector/direction from Red_Pixel to the closest Magenta_Pixel and its opposite. Categorize as Horizontal/Vertical or Diagonal.
      - Trace_and_Identify: Follow the ray trace path based on the Opposite_Direction.
          - If Horizontal/Vertical: Find the first non-Orange pixel. This is the Target_Pixel.
          - If Diagonal: Find the last Orange pixel just before the first non-Orange pixel (or grid boundary). This is the Target_Pixel.
      - Change_Color: Modify the color of the identified Target_Pixel.
          - If Horizontal/Vertical trace: Change Target_Pixel to Orange (7).
          - If Diagonal trace: Change Target_Pixel to Gray (5).
    ```


*   **Natural Language Program**
    1.  Identify the unique red (color 2) pixel in the input grid. Let its coordinates be (R_row, R_col).
    2.  Identify all magenta (color 6) pixels. Find the magenta pixel closest to the red pixel (using Euclidean distance, breaking ties arbitrarily if needed, though not observed in examples). Let its coordinates be (M_row, M_col).
    3.  Determine the direction vector from the red pixel to the closest magenta pixel: (d_row = M_row - R_row, d_col = M_col - R_col). Normalize or simplify this vector to represent a primary direction (e.g., Right, Left, Up, Down, Up-Left, Down-Right, etc.).
    4.  Determine the opposite direction to the one found in step 3.
    5.  Check if the opposite direction is purely horizontal (change in column only) or vertical (change in row only).
        *   If YES (Horizontal/Vertical):
            a.  Starting from the red pixel's location, trace step-by-step along the grid line (row or column) in the opposite direction.
            b.  Examine the color of each pixel encountered along this trace.
            c.  Stop at the first pixel (P) whose color is *not* orange (7).
            d.  Modify the output grid by changing the color of pixel P to orange (7). Keep all other pixels the same as the input.
        *   If NO (Diagonal):
            a.  Starting from the red pixel's location, trace step-by-step along the diagonal path in the opposite direction.
            b.  Keep track of the last pixel encountered (P_last_orange) whose color *was* orange (7).
            c.  Stop when the trace encounters a pixel whose color is *not* orange (7) or steps off the grid boundary.
            d.  Modify the output grid by changing the color of the pixel identified as P_last_orange to gray (5). Keep all other pixels the same as the input.
    6.  Return the modified grid as the output.
