
## train_1

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
5 0 1 0 0 0 1 1 1 1 0 0 2 2 2 2 2 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 3 0 0
0 0 1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 3 0 0
0 0 1 1 0 0 0 0 0 1 0 0 4 4 4 0 5 0 0 3 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 5 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4 4 0 0 0 5
0 0 0 0 5 0 0 4 0 0 4 4 4 4 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 0 0 4 4 0 0 4 4 4 4 0 0 0 0
0 8 8 0 0 0 0 4 4 4 4 4 0 0 4 4 4 4 0 0 0 0
0 8 8 0 0 0 0 4 4 4 4 4 0 0 4 4 4 4 0 5 0 0
0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0
0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0
0 0 0 2 2 2 2 2 0 0 0 0 5 0 0 0 0 3 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 4 4 4 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 2 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 2 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 8 8 4 4 4 4 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 8 8 4 4 3 3 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 4 4 4 4 3 3 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 4 4 4 4 3 3 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


## train_2

**input:**
```
5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 3 3 0 0 0 0
0 0 0 2 0 0 0 0 2 2 2 0 2 2 0 0 0 0 0 0 0 5 0
5 0 0 2 0 0 0 0 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 0 0 0 0 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 8 8 8 0 0 0 0
0 0 0 2 2 2 0 0 0 0 0 0 2 2 0 0 8 8 8 0 0 0 0
0 0 0 2 2 2 0 0 0 0 0 0 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 6 6 6 6 6 6
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 6 6 6 6 6 6
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 6 6 6 6 6
0 0 0 8 8 8 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0
0 0 0 8 8 8 0 0 0 1 1 1 0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 1 0 0 0 0
0 4 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 5 0
0 0 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 1 0 0 0 0
0 0 0 4 4 4 4 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0
0 0 0 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 4 4 4 4 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 4 4 4 4 2 2 2 4 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 4 4 4 4 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 4 4 4 4 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 8 8 8 8 8 8 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 8 8 8 8 8 8 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 6 6 6 6 6 6 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 6 6 6 6 6 6 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 6 6 6 6 6 6 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 3 3 1 1 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


## train_3

**input:**
```
0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 0 5 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 2 2 2 0 0 0 0 0
0 1 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 1 1 1 1 1 0 0 0 5 0 0 0 0 5 0
0 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 0 0 0 0 0 1 1 0 0 0 4 4 4 4 0 0 0
0 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 8 0 5 0
0 1 1 1 0 0 1 1 0 1 0 0 5 0 0 0 8 0 0 0
0 1 1 1 0 0 1 1 1 1 0 0 0 0 0 0 8 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 8 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 3 3 0 0 0 5 0 0 0 0 5
0 0 0 0 0 0 0 0 0 3 3 0 0 0 0 0 0 0 0 0
0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 4 0 5 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 2 2 2 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 2 2 2 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 8 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 8 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 4 4 4 4 8 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 8 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 3 3 1 1 4 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 3 3 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

*   **Perception:**
    The task involves modifying specific shapes within the input grid based on the proximity of other elements. The input grids contain several distinct types of elements:
    1.  **Container Objects:** Large shapes (like blue 'U' in ex 1, red 'S' in ex 2, blue shape in ex 3) that enclose contiguous regions of the background color (white). These containers persist into the output grid, but their internal white regions are modified.
    2.  **Filler Objects:** Smaller, solid colored objects (red, green, yellow, azure, magenta in the examples) scattered around the grid, usually not adjacent to the containers. These objects do not appear directly in the output grid but determine the color used to fill the containers.
    3.  **Marker Objects:** Single pixels of gray color (5). These markers also do not appear in the output grid but act as intermediaries, linking specific filler objects to specific internal regions of the containers.
    4.  **Background:** White pixels (0).

    The core transformation involves identifying the internal white regions within the container objects. For each such region, a specific gray marker pixel is identified (the one closest to the region). Then, the filler object closest to *that* gray marker pixel dictates the color used to fill the corresponding internal white region in the container. Finally, the output grid consists only of the modified container objects against a white background; the original filler objects and gray markers are removed.

*   **Facts:**
    
```yaml
    task_elements:
      - element: grid
        description: A 2D array of pixels with colors 0-9.
      - element: background_pixel
        properties:
          color: white
          value: 0
      - element: object
        description: A contiguous region of pixels with the same non-white color.
        types:
          - container_object:
              properties:
                - color: any non-white, non-gray color (e.g., blue, red, yellow)
                - shape: variable, must enclose one or more regions of background pixels.
                - enclosed_regions: list of contiguous white pixel areas inside the container boundary.
              actions:
                - identify based on enclosing background pixels.
                - modify by filling enclosed_regions.
                - copy to output grid.
          - filler_object:
              properties:
                - color: any non-white, non-gray color (e.g., red, green, yellow, azure, magenta)
                - shape: variable, typically smaller than containers, does not enclose background.
              actions:
                - identify based on color (not container, not marker).
                - determine fill color based on proximity to marker.
                - remove from output grid.
          - marker_object:
              properties:
                - color: gray
                - value: 5
                - shape: typically single pixel, but could be contiguous gray region.
              actions:
                - identify by color.
                - link enclosed_regions to filler_objects via proximity.
                - remove from output grid.

    relationships:
      - type: proximity
        description: Used to find the closest marker to a region and the closest filler to a marker. Calculation likely based on minimum Euclidean distance between any pixel of the two elements.
      - type: containment
        description: Container objects enclose background pixel regions.

    transformation:
      - action: find_containers
        description: Identify all objects enclosing background regions.
      - action: find_markers
        description: Identify all gray objects/pixels.
      - action: find_fillers
        description: Identify all non-white, non-gray objects that are not containers.
      - action: process_containers
        description: For each container object
        steps:
          - identify_internal_regions: Find all distinct contiguous white regions inside the container.
          - for_each_region:
              - find_closest_marker: Determine the single gray marker pixel closest to this specific white region.
              - find_closest_filler_to_marker: Determine the filler object closest to the identified gray marker pixel.
              - get_filler_color: Note the color of this closest filler object.
              - fill_region: Change the color of all white pixels within the current internal region to the determined filler color.
      - action: generate_output
        description: Create a new grid of the same size, initialized to white. Copy only the modified container objects onto this grid. Discard original markers and fillers.

    assumptions:
      - Each internal white region corresponds to exactly one closest gray marker.
      - Each relevant gray marker corresponds to exactly one closest filler object.
      - Distance metric is likely minimum Euclidean distance between pixels.
    ```


*   **Natural Language Program:**
    1.  Initialize the output grid as a copy of the input grid, or as a new grid of the same dimensions filled with the background color (white).
    2.  Identify all distinct objects in the input grid (contiguous blocks of the same non-white color).
    3.  Categorize the objects:
        *   Identify "container" objects: those that fully enclose one or more regions of white pixels.
        *   Identify "marker" objects: those with gray color (5).
        *   Identify "filler" objects: all remaining non-white objects (i.e., not containers and not markers).
    4.  Create a list of all internal white regions from all container objects.
    5.  For each internal white region found:
        a.  Calculate the distance (e.g., minimum Euclidean distance between any pixel of the region and the marker pixel) from this region to every marker object (gray pixel).
        b.  Identify the single marker object that is closest to this region.
        c.  Calculate the distance (e.g., minimum Euclidean distance) from this closest marker object to every filler object.
        d.  Identify the single filler object that is closest to this marker object.
        e.  Get the color of this closest filler object.
        f.  In the grid being prepared for output (can be the input grid copy or the new grid), change the color of all pixels belonging to the current internal white region to this filler color.
    6.  Create the final output grid: Start with a white grid of the same dimensions as the input. Copy *only* the pixels belonging to the original container objects (which now include the filled regions from step 5f) onto the output grid. Ensure all original marker pixels and filler object pixels are *not* copied and remain background color (white) in the final output, unless they were overwritten by a fill operation within a container.
