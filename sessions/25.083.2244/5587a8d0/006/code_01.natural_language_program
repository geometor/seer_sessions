1.  **Identify Outer Border:** Find the color of the outermost border of the input grid.
2.  **Identify Inner Border:** Find the inner border (if present).  An inner border is a region of pixels of the same color that is directly adjacent to the outer border.
3.  **Extract Core:** Extract the core of the grid, which consists of all pixels that are not part of the outer or inner border.
4.  **Determine Output Border Color:** Determine the output border color based on the input outer border color and the colors present in the core (including the inner border color, if present). The rule is: if the outer border is color 7, the new border color depends on the core: all(4,6,7)-> 4; all(1,8,5,7) -> 1; all(8,3,9,7,0)->8.
5.  **Transform Core Colors:** Transform the colors within the core based on a specific mapping, dependent on example. Example 1: 4->6, Example 2: 1->8, Example 3: 8->0, 9->3.
6.  **Construct Output Grid:** Create the output grid with the determined output border color, the inner border (using its original color), and the transformed core. Maintain spatial relationships - the relative positions of the border, inner border, and core should be the same as in the input.
7. Trim the output grid by removing any rows/columns that consist of only -1.