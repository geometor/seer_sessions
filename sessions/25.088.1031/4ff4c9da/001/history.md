
## train_1

**input:**
```
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 8 8 8 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
```


**output:**
```
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 8 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
1 1 1 2 8 8 8 2 1 1 1 2 1 1 1 2 8 8 8 2 1
0 0 1 2 0 8 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
0 0 1 2 0 1 0 2 1 0 0 2 0 0 1 2 0 1 0 2 1
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
0 0 1 2 0 8 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
1 1 1 2 8 8 8 2 1 1 1 2 1 1 1 2 8 8 8 2 1
0 0 1 2 0 8 0 2 1 0 0 2 0 0 1 2 0 8 0 2 1
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1
```


## train_2

**input:**
```
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 8 8 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 8 1 2 1 2 2 2
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 8 1 2 1 2 2 2
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
```


**output:**
```
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 8 8 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 8 1 2 2 2 1 2 2 2 1 8 1 8 1 2 2 2
2 2 2 1 2 1 8 1 2 2 2 1 2 2 2 1 8 1 8 1 2 2 2
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 8 8 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 2 1 2 1 0 1 8 8 0 1 0 0 2 1 0 1 0 1 2 0 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 2
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
0 0 2 1 2 1 0 1 2 2 0 1 0 0 2 1 0 1 0 1 2 0 0
```


## train_3

**input:**
```
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
1 1 1 1 2 2 1 1 1 2 1 1 1 1 2 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 1 8 1 1 1 2 1 1 2 2 2 1 2
2 2 2 1 8 1 8 1 2 1 2 1 2 2 2 1 2
0 0 1 1 1 8 0 1 1 2 0 1 0 0 2 1 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 2 1 1 1 2 1 1 1 1 2 1 1
8 8 8 1 2 1 2 1 2 1 2 1 2 2 2 1 2
0 0 1 1 1 2 0 1 1 2 0 1 0 0 2 1 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
2 2 2 1 2 2 2 1 2 2 2 1 2 2 2 1 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
```


**output:**
```
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
1 1 1 1 2 2 1 1 1 2 1 1 1 1 2 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
2 2 2 1 1 8 1 1 1 8 1 1 2 2 2 1 2
2 2 2 1 8 1 8 1 8 1 8 1 2 2 2 1 2
0 0 1 1 1 8 0 1 1 8 0 1 0 0 2 1 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 8 1 1 1 8 1 1 1 1 2 1 1
8 8 8 1 8 1 8 1 8 1 8 1 2 2 2 1 2
0 0 1 1 1 8 0 1 1 8 0 1 0 0 2 1 0
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
8 8 8 1 2 2 2 1 2 2 2 1 2 2 2 1 2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
0 0 1 1 2 2 0 1 1 2 0 1 0 0 2 1 0
```

Okay, let's break down this task.

## Perception

1.  **Grid Structure:** The input and output grids are the same size in each example. They contain various colors, with White (0) often acting as a background or separator. Colors like Blue (1) and Red (2) frequently form repeating lines or patterns, suggesting a structured background.
2.  **Key Color:** The Azure (8) color plays a crucial role. It appears in specific locations in the input grids.
3.  **Transformation:** The primary change between input and output grids is the appearance of *new* Azure (8) pixels in the output. These new Azure pixels replace pixels of other colors (primarily Blue (1) or Red (2) in the examples).
4.  **Pattern Recognition:** The Azure (8) pixels in the input form distinct shapes or patterns (e.g., a plus sign, a bar, a 2x1 block, a 1x2 block).
5.  **Rule Inference:** The transformation seems to involve using the Azure (8) shapes found in the input as templates. The process finds other locations in the grid that contain the *exact same shape* but are composed of a *single* other color (like Blue (1) or Red (2)). These found shapes are then "recolored" to match the template color, Azure (8). The original Azure shapes remain unchanged.

## Facts


```yaml
elements:
  - element: grid
    properties:
      - background_color: white (0)
      - structural_colors: [blue (1), red (2)]
      - template_color: azure (8)
      - size: constant between input and output (e.g., 21x21, 23x23, 17x17)

objects:
  - object: source_pattern
    description: A contiguous block of one or more azure (8) pixels in the input grid.
    properties:
      - color: azure (8)
      - shape: relative coordinates of constituent pixels
      - bounding_box_size: height and width of the smallest rectangle enclosing the shape

  - object: target_pattern
    description: A block of pixels in the input grid identified for transformation.
    properties:
      - shape: must exactly match the shape of a source_pattern
      - bounding_box_size: must exactly match the bounding_box_size of the corresponding source_pattern
      - color: must be composed entirely of a single color, which is not azure (8) and not white (0).

actions:
  - action: identify_source_patterns
    description: Find all maximal contiguous blocks of azure (8) pixels in the input grid.
    inputs: input_grid
    outputs: list of source_patterns (shape, bounding_box_size)

  - action: find_target_patterns
    description: For each source_pattern, search the input grid for blocks matching its shape and bounding_box_size, composed of a single non-azure, non-white color.
    inputs: input_grid, list of source_patterns
    outputs: list of target_patterns (location, shape, original_color)

  - action: recolor_target_patterns
    description: Change the color of all pixels within each identified target_pattern to azure (8).
    inputs: output_grid (initially a copy of input_grid), list of target_patterns
    outputs: modified output_grid

relationships:
  - relationship: shape_matching
    description: A target_pattern must have the identical relative pixel coordinates (shape) and bounding box size as a source_pattern.
  - relationship: color_constraint
    description: A target_pattern must consist of only one color, and that color cannot be azure (8) or white (0).
```


## Natural Language Program

1.  Create a copy of the input grid to serve as the initial output grid.
2.  Scan the input grid to find all distinct, contiguous blocks (shapes) made entirely of Azure (8) pixels. Record the shape (relative pixel coordinates) and bounding box size of each unique Azure block found. These are the "source patterns".
3.  For each unique source pattern identified in step 2:
    a.  Scan the entire input grid again.
    b.  Look for locations where a block of pixels exists that exactly matches the shape and bounding box size of the current source pattern.
    c.  Check if this matching block is composed entirely of a *single color* that is *not* Azure (8) and *not* White (0).
    d.  If such a matching, single-colored block is found (a "target pattern"), modify the output grid by changing the color of all pixels within that block's location to Azure (8).
4.  Return the modified output grid.
