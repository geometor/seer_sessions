
## train_1

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 2 0 6 0 2 1 1 1 1 1 1 1 0 0 0 0
0 0 1 0 0 0 2 6 6 6 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 2 0 6 0 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 2 2 2 2 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 0 3 0 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 3 0 3 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 0 3 0 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0 0
0 0 1 0 0 0 0 0 2 2 2 2 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 0 8 0 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 0 8 8 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 8 0 0 2 0 0 0 0 1 0 0 0 0
0 0 1 1 1 1 1 1 2 2 2 2 2 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 2 0 3 0 2 1 1 1 1 1 1 1 0 0 0 0
0 0 1 0 0 0 2 3 3 3 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 2 0 3 0 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 2 2 2 2 2 0 0 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 0 8 0 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 8 0 8 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 0 8 0 2 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0 0
0 0 1 0 0 0 0 0 2 2 2 2 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 0 6 0 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 0 6 6 2 0 0 0 0 1 0 0 0 0
0 0 1 0 0 0 0 0 2 6 0 0 2 0 0 0 0 1 0 0 0 0
0 0 1 1 1 1 1 1 2 2 2 2 2 1 1 1 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


## train_2

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 2 0 3 0 2 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 2 3 3 3 2 1 1 1 1 1 1 0 0 0
0 0 1 0 0 0 0 2 0 3 0 2 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 0 2 2 2 2 2 0 0 0 0 0 1 0 0 0
0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 2 0 7 7 2 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0
0 2 7 7 0 2 0 0 0 0 0 0 0 0 0 2 8 8 0 2 0
0 2 7 0 0 2 0 0 0 0 0 0 0 0 0 2 8 8 0 2 0
0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 2 0 0 8 2 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 2 2 2 2 2 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 2 0 6 0 2 0 0 0 0 0 0 1 0 0 0
0 0 1 1 1 1 2 0 6 6 2 1 1 1 1 1 1 1 0 0 0
0 0 0 0 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 2 0 8 0 2 0 0 0 0 0 0 0 0 0
0 0 1 1 1 1 1 2 8 8 8 2 1 1 1 1 1 1 0 0 0
0 0 1 0 0 0 0 2 0 8 0 2 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 0 2 2 2 2 2 0 0 0 0 0 1 0 0 0
0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 2 0 3 3 2 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0
0 2 3 3 0 2 0 0 0 0 0 0 0 0 0 2 6 6 0 2 0
0 2 3 0 0 2 0 0 0 0 0 0 0 0 0 2 6 6 0 2 0
0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 2 0 0 6 2 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 2 2 2 2 2 0 0 0 0 0 0 1 0 0 0
0 0 1 0 0 0 2 0 7 0 2 0 0 0 0 0 0 1 0 0 0
0 0 1 1 1 1 2 0 7 7 2 1 1 1 1 1 1 1 0 0 0
0 0 0 0 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


## train_3

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 0 0 8 0 0 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 0 8 8 8 0 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 1 1 1 1 1 2 0 8 0 8 0 2 1 1 1 1 1 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 0 8 0 8 0 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 2 2 2 2 2 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0
0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 2 0 0 4 4 0 2 0 0
0 2 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 2 4 4 4 0 4 2 0 0
0 2 3 0 3 0 0 2 0 0 0 0 0 0 0 0 0 2 0 0 4 4 0 2 0 0
0 2 3 3 3 3 0 2 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0
0 2 3 0 3 0 0 2 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0
0 2 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```


**output:**
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 0 0 4 0 0 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 2 0 4 4 4 0 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 1 1 1 1 1 2 0 4 0 4 0 2 1 1 1 1 1 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 0 4 0 4 0 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 2 2 2 2 2 2 2 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0
0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 2 0 0 3 3 0 2 0 0
0 2 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 2 3 3 3 0 3 2 0 0
0 2 8 0 8 0 0 2 0 0 0 0 0 0 0 0 0 2 0 0 3 3 0 2 0 0
0 2 8 8 8 8 0 2 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0
0 2 8 0 8 0 0 2 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 0 0
0 2 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

**Perception:**

The input grids contain a background (White), a consistent L-shaped border (Blue) on the left and bottom edges, and several rectangular frames made of Red pixels. Inside each Red frame, there is a pattern composed of a single other color (e.g., Green, Magenta, Azure, Orange, Yellow). The core task is to change the color of the pattern *inside* each Red frame based on specific rules. The background, the Blue border, and the Red frames themselves remain unchanged in the output.

The transformation rule for the color inside a Red frame depends on two factors:
1.  The dimensions of the Red frame. Two sizes appear: 5x5 and 7x7.
2.  The original color of the pattern inside the frame.
3.  For one specific case (Magenta color inside a 5x5 frame), the transformation also depends on whether the frame is adjacent (including diagonals) to any part of the Blue L-shaped border.

**Facts:**


```yaml
Objects:
  - type: Background
    color: White (0)
    role: Static backdrop
  - type: Border
    color: Blue (1)
    shape: L-shape along left and bottom edges
    role: Static structural element, potential modifier for adjacent objects
  - type: Frame
    color: Red (2)
    shape: Rectangle (variable size, observed 5x5 and 7x7)
    role: Container defining regions for transformation
  - type: Pattern
    color: Variable (Green(3), Yellow(4), Magenta(6), Orange(7), Azure(8))
    shape: Contiguous block of single color located inside a Frame
    role: Subject of transformation

Relationships:
  - Pattern is located 'inside' Frame.
  - Frame can be 'adjacent' (including diagonally) to Border.

Actions:
  - Identify: Locate all Red Frames.
  - Measure: Determine the dimensions (height x width) of each Frame.
  - Identify: Find the color of the Pattern inside each Frame.
  - Check Adjacency: For 5x5 Frames containing Magenta Patterns, check if the Frame is adjacent to the Blue Border.
  - Transform Color: Change the color of the Pattern based on Frame size, original Pattern color, and (for the Magenta/5x5 case) adjacency to the Border.
  - Copy: Preserve the color and position of Background, Border, and Frame pixels.

Color Transformations:
  - Rule Set 1 (Frame size 5x5):
    - Green(3) -> Azure(8)
    - Azure(8) -> Magenta(6)
    - Orange(7) -> Green(3)
    - Magenta(6):
      - If Frame is adjacent to Blue(1) Border -> Orange(7)
      - If Frame is NOT adjacent to Blue(1) Border -> Green(3)
  - Rule Set 2 (Frame size 7x7):
    - Green(3) -> Azure(8)
    - Azure(8) -> Yellow(4)
    - Yellow(4) -> Green(3)
```


**Natural Language Program:**

1.  Create a copy of the input grid to serve as the output grid.
2.  Find all distinct rectangular frames composed of Red (2) pixels in the input grid.
3.  For each Red frame found:
    a.  Determine its dimensions (height and width).
    b.  Identify the single color (`C_in`) of the non-Red (2), non-White (0) pixels enclosed within the boundaries of the frame.
    c.  Determine the target color (`C_out`) based on the frame's dimensions and `C_in`:
        i.  If the frame is 5x5:
            *   If `C_in` is Green (3), set `C_out` to Azure (8).
            *   If `C_in` is Azure (8), set `C_out` to Magenta (6).
            *   If `C_in` is Orange (7), set `C_out` to Green (3).
            *   If `C_in` is Magenta (6): Check if any Red (2) pixel forming the frame boundary has a Blue (1) pixel as an immediate (8-way) neighbour. If yes, set `C_out` to Orange (7); otherwise, set `C_out` to Green (3).
        ii. If the frame is 7x7:
            *   If `C_in` is Green (3), set `C_out` to Azure (8).
            *   If `C_in` is Azure (8), set `C_out` to Yellow (4).
            *   If `C_in` is Yellow (4), set `C_out` to Green (3).
    d.  Iterate through all pixels within the boundaries of the current Red frame in the output grid. If a pixel's color matches `C_in` in the input grid, change its color to `C_out` in the output grid.
4.  Return the modified output grid. (Pixels not identified as part of an inner pattern within a red frame retain their original color).
