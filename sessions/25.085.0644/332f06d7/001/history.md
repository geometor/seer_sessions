
## train_1

**input:**
```
3 2 2 3 3 3 3 3 3 3 3 3
3 2 2 3 3 3 3 3 3 3 3 3
3 1 1 3 3 3 3 3 3 3 3 3
3 1 1 3 1 1 1 1 1 1 3 3
3 1 1 3 1 1 1 1 1 1 3 3
3 1 1 3 1 1 3 1 1 1 3 3
3 1 1 3 1 1 3 1 1 1 1 3
3 1 1 1 1 1 3 1 1 1 1 3
3 1 1 1 1 1 3 3 1 1 3 3
3 1 1 1 3 3 3 3 0 0 3 3
3 3 3 3 3 3 3 3 0 0 3 3
3 3 3 3 3 3 3 3 3 3 3 3
```


**output:**
```
3 0 0 3 3 3 3 3 3 3 3 3
3 0 0 3 3 3 3 3 3 3 3 3
3 1 1 3 3 3 3 3 3 3 3 3
3 1 1 3 1 1 1 1 1 1 3 3
3 1 1 3 1 1 1 1 1 1 3 3
3 1 1 3 1 1 3 1 1 1 3 3
3 1 1 3 1 1 3 1 1 1 1 3
3 1 1 1 1 1 3 1 1 1 1 3
3 1 1 1 1 1 3 3 1 1 3 3
3 1 1 1 3 3 3 3 1 1 3 3
3 3 3 3 3 3 3 3 1 1 3 3
3 3 3 3 3 3 3 3 3 3 3 3
```


## train_2

**input:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 1 1 0 0 3 3
3 3 3 3 3 1 1 1 1 1 0 0 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 1 1 3 3 3 3
3 3 3 3 3 1 1 1 1 1 3 3 3 3
3 3 3 3 3 3 3 3 3 1 3 3 3 3
3 1 1 1 1 1 1 1 1 1 3 3 3 3
3 1 1 1 1 1 1 1 1 1 3 3 3 3
3 2 2 3 3 3 3 3 3 3 3 3 3 3
3 2 2 3 3 3 3 3 3 3 3 3 3 3
```


**output:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 1 1 1 1 3 3
3 3 3 3 3 1 1 1 1 1 1 1 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 0 0 3 3 3 3
3 3 3 3 3 1 1 1 0 0 3 3 3 3
3 3 3 3 3 3 3 3 3 1 3 3 3 3
3 1 1 1 1 1 1 1 1 1 3 3 3 3
3 1 1 1 1 1 1 1 1 1 3 3 3 3
3 2 2 3 3 3 3 3 3 3 3 3 3 3
3 2 2 3 3 3 3 3 3 3 3 3 3 3
```


## train_3

**input:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 3
2 2 2 1 1 1 1 3 3 1 1 1 1 1 1 3
2 2 2 1 1 3 3 3 3 3 1 1 1 1 1 3
3 3 3 3 3 3 3 3 3 3 3 3 3 1 1 3
3 3 3 1 1 1 1 1 1 1 3 3 3 1 1 3
3 3 3 1 1 1 1 1 1 1 3 3 3 1 1 3
3 3 3 1 1 1 1 1 1 1 3 3 3 1 1 3
3 3 1 1 1 1 3 1 1 1 3 3 3 1 1 3
3 3 1 1 1 1 3 1 1 3 3 3 1 1 1 3
3 3 1 1 1 1 3 1 1 3 3 3 1 1 1 3
3 3 1 1 1 3 3 1 1 3 3 3 1 1 1 3
3 0 0 0 1 3 3 1 1 1 1 1 1 1 1 3
3 0 0 0 1 3 3 1 1 1 1 1 1 1 1 3
3 0 0 0 1 3 3 1 1 1 1 1 1 1 1 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```


**output:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 3
2 2 2 1 1 1 1 3 3 1 1 1 1 1 1 3
2 2 2 1 1 3 3 3 3 3 1 1 1 1 1 3
3 3 3 3 3 3 3 3 3 3 3 3 3 1 1 3
3 3 3 1 1 1 1 1 1 1 3 3 3 1 1 3
3 3 3 1 1 1 1 0 0 0 3 3 3 1 1 3
3 3 3 1 1 1 1 0 0 0 3 3 3 1 1 3
3 3 1 1 1 1 3 0 0 0 3 3 3 1 1 3
3 3 1 1 1 1 3 1 1 3 3 3 1 1 1 3
3 3 1 1 1 1 3 1 1 3 3 3 1 1 1 3
3 3 1 1 1 3 3 1 1 3 3 3 1 1 1 3
3 1 1 1 1 3 3 1 1 1 1 1 1 1 1 3
3 1 1 1 1 3 3 1 1 1 1 1 1 1 1 3
3 1 1 1 1 3 3 1 1 1 1 1 1 1 1 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```


## train_4

**input:**
```
3 3 3 3 3 3 3 3 3 3
3 0 1 1 3 3 3 3 3 3
3 3 3 1 3 1 1 1 3 3
3 3 3 1 3 1 3 1 3 3
3 3 3 1 1 1 3 1 3 3
3 3 3 3 3 3 3 1 3 3
3 3 3 3 1 1 1 1 3 3
3 3 3 3 1 3 3 3 3 3
3 3 3 3 1 3 3 3 3 3
3 3 3 3 2 3 3 3 3 3
```


**output:**
```
3 3 3 3 3 3 3 3 3 3
3 1 1 1 3 3 3 3 3 3
3 3 3 1 3 1 1 1 3 3
3 3 3 1 3 1 3 1 3 3
3 3 3 1 1 1 3 1 3 3
3 3 3 3 3 3 3 1 3 3
3 3 3 3 1 1 1 1 3 3
3 3 3 3 1 3 3 3 3 3
3 3 3 3 1 3 3 3 3 3
3 3 3 3 0 3 3 3 3 3
```

Okay, let's analyze the task examples.

**Perception of Elements:**

1.  **Colors:** The grids primarily use green (3), blue (1), red (2), and white (0). Green appears to be the background color in most cases.
2.  **Objects:**
    *   **Red Object:** In each input grid, there is exactly one contiguous object composed of red (2) pixels. Its shape varies (2x2 square, 3x3 square, single pixel).
    *   **White Object(s):** Each input grid contains at least one contiguous object composed of white (0) pixels. The shape also varies (2x2, 3x3, single pixel). Some inputs have multiple white objects (e.g., train\_2).
    *   **Blue Path:** There are paths or areas composed of blue (1) pixels. These blue pixels appear to connect or lie between the red object and at least one white object.
    *   **Background:** The most frequent color is green (3), acting as the background.
3.  **Transformation:** The core transformation involves a change related to the red and white objects.
    *   The original red object's location is replaced with the background color (green, 3).
    *   The location of *one* of the white objects is replaced with blue (1).
4.  **Selection Criteria:** When multiple white objects exist (train\_2), only one is affected. The blue path seems crucial for determining *which* white object is targeted. The affected white object appears to be the one "closest" to the red object, reachable via the blue path. Closeness here likely refers to the path distance traveling only through blue pixels.

**YAML Facts:**


```yaml
facts:
  constants:
    - background_color: 3  # Green, typically the most frequent color
    - agent_color: 2       # Red
    - path_color: 1        # Blue
    - target_color: 0      # White
    - result_color: 1      # Blue (replaces target)
  objects:
    - id: red_object
      color: agent_color (2)
      count: 1
      description: A single contiguous object of red pixels.
    - id: white_objects
      color: target_color (0)
      count: 1 or more
      description: Contiguous objects of white pixels.
    - id: blue_path
      color: path_color (1)
      description: Contiguous or scattered blue pixels often forming a path or region connecting the red_object to one or more white_objects.
  relationships:
    - type: connectivity
      description: The red_object is connected to at least one white_object via adjacent blue_path pixels.
    - type: selection
      description: If multiple white_objects are connected to the red_object via the blue_path, the target white_object is the one reachable with the shortest path distance along the blue_path starting from the red_object. Adjacency includes diagonals.
  actions:
    - action: find_objects
      inputs: [input_grid, agent_color, target_color, path_color]
      outputs: [red_object_coords, list_of_white_object_coords, blue_path_coords]
    - action: determine_background
      inputs: [input_grid]
      outputs: [background_color]
      description: Find the most frequent pixel color in the grid.
    - action: find_target_white_object
      inputs: [red_object_coords, list_of_white_object_coords, blue_path_coords]
      outputs: [target_white_object_coords]
      description: Perform a shortest path search (e.g., BFS) starting from red_object, moving through adjacent blue_path pixels, to find the first reachable white_object.
    - action: modify_grid
      inputs: [input_grid, red_object_coords, target_white_object_coords, background_color, result_color]
      outputs: [output_grid]
      description: Create a copy of the input grid. Replace pixels at red_object_coords with background_color. Replace pixels at target_white_object_coords with result_color.
```


**Natural Language Program:**

1.  Identify the background color by finding the most frequent color in the input grid (this is expected to be green, color 3).
2.  Locate the single, contiguous red object (color 2) and record the coordinates of all its pixels.
3.  Locate all distinct, contiguous white objects (color 0) and record the coordinates for each object separately.
4.  Identify all blue pixels (color 1) which form the potential path(s).
5.  Determine the 'target' white object:
    a.  Initiate a Breadth-First Search (BFS). The starting points for the search are all blue pixels that are adjacent (including diagonally) to any pixel of the red object.
    b.  The search progresses from a blue pixel only to adjacent (including diagonally) blue pixels that haven't been visited yet.
    c.  During the search, at each step, check if the current blue pixel is adjacent (including diagonally) to any pixel belonging to *any* of the white objects identified in step 3.
    d.  If such an adjacency is found, the corresponding white object is the 'target' white object. Record the coordinates of this target white object and stop the search.
6.  Create the output grid by making a copy of the input grid.
7.  Modify the output grid:
    a.  For each coordinate recorded for the red object in step 2, change the pixel color at that coordinate in the output grid to the background color identified in step 1.
    b.  For each coordinate recorded for the target white object in step 5d, change the pixel color at that coordinate in the output grid to blue (color 1).
8.  The resulting modified grid is the final output.
