
## train_1

**input:**
```
0 4 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 9 0 0 0 7 0 0 0 0 0 4 0
0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0
0 0 3 0 0 0 0 0 0 0 4 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7
7 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 9
0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0
0 2 0 0 0 0 0 0 0 0 3 0 0 0 0 4 0
6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 6
0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0
0 8 0 0 0 2 0 0 0 0 7 0 0 0 6 0 0
0 0 6 0 0 0 0 0 0 4 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 5 0 0 0 5 0 0 0 0 5 0 0
```


**output:**
```
0 4 0 0 8 9 0 0 0 7 0 0 0 0 9 0 0
0 0 0 0 0 9 0 0 0 7 0 0 0 0 9 4 0
0 0 0 0 0 1 0 0 0 4 0 0 0 0 9 0 0
0 0 3 0 0 2 0 0 0 4 4 0 0 0 9 0 0
0 0 0 0 0 2 0 0 0 4 0 0 0 0 9 0 0
0 0 0 0 0 2 0 0 0 4 0 0 0 0 6 0 7
7 0 0 0 0 2 0 9 0 4 0 0 0 0 6 0 9
0 0 0 3 0 2 0 0 0 4 0 0 0 0 6 0 0
0 2 0 0 0 2 0 0 0 4 3 0 0 0 6 4 0
6 0 0 0 0 2 0 0 0 4 0 0 0 0 6 0 0
0 0 0 0 0 2 0 0 0 4 0 0 0 0 6 0 0
0 0 0 0 0 2 0 0 0 4 4 0 0 0 6 0 6
0 0 0 0 0 2 0 0 0 4 0 2 0 0 6 0 0
0 8 0 0 0 2 0 0 0 4 7 0 0 0 6 0 0
0 0 6 0 0 5 0 0 0 4 0 0 0 0 5 0 0
0 0 0 0 0 5 0 0 0 5 0 0 0 0 5 0 0
0 0 0 0 0 5 0 0 0 5 0 0 0 0 5 0 0
```


## train_2

**input:**
```
8 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 1 0 0 0 6
0 0 0 8 0 0 8 0 0 0 0 2 0
0 0 7 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 6 0 4 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 4 0 0 6 0 0 0 0 0
0 0 0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 3 0 0 0 0 0 0
0 3 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 8 0 0 0 6 0 0 0 2
0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 5 0 0 0 5 0 0 0 0
```


**output:**
```
8 0 0 0 4 0 0 0 1 0 0 0 0
0 0 0 0 4 0 0 0 1 0 0 0 6
0 0 0 8 4 0 8 0 6 0 0 2 0
0 0 7 0 4 0 0 0 6 0 0 0 0
0 0 0 0 4 0 0 0 6 0 4 0 0
0 0 0 0 4 0 0 0 6 0 0 0 0
0 0 0 0 4 0 0 6 6 0 0 0 0
0 0 0 0 8 0 0 0 6 1 0 0 0
0 0 0 0 8 0 3 0 6 0 0 0 0
0 3 0 0 8 0 0 0 6 0 0 0 0
0 0 0 0 8 0 0 0 6 0 0 0 2
0 0 0 0 5 0 0 0 5 0 0 0 0
0 0 0 0 5 0 0 0 5 0 0 0 0
```


## train_3

**input:**
```
0 0 0 0 0 0 0 0 0 0 0 0
0 0 3 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 3 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 7 0 0 0
0 0 0 0 0 0 0 0 6 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 4 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 8 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 5 0 0 0 0 0 5 0 0 0
```


**output:**
```
0 0 3 0 0 0 0 0 7 0 0 0
0 0 3 0 0 0 0 0 7 0 0 0
0 0 3 0 0 0 0 0 7 0 0 0
0 0 3 0 0 0 0 0 7 0 0 0
0 0 4 0 0 0 0 0 7 0 0 0
0 0 4 0 0 0 0 0 6 0 0 0
0 0 4 0 0 0 0 0 8 0 0 0
0 0 4 0 0 0 0 0 8 0 0 0
0 0 5 0 0 0 0 0 8 0 0 0
0 0 5 0 0 0 0 0 5 0 0 0
0 0 5 0 0 0 0 0 5 0 0 0
0 0 5 0 0 0 0 0 5 0 0 0
```


## train_4

**input:**
```
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 6 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 5 0 0 0
```


**output:**
```
0 0 0 6 0 0 0
0 0 0 6 0 0 0
0 0 0 6 0 0 0
0 0 0 6 0 0 0
0 0 0 5 0 0 0
0 0 0 5 0 0 0
0 0 0 5 0 0 0
```

**Perception of the Elements:**

The task involves transforming a 2D grid (matrix) of integers. The input grid contains single-digit integers (0-9), where 0 represents an empty cell, and non-zero digits represent filled cells. The output grid is derived from the input grid by modifying some of the zero cells. The core transformation appears to operate vertically, within each column independently. Non-zero numbers seem to "propagate" or "fill" downwards into the zero cells below them, but only until another non-zero number is encountered in the same column. Zeros above the topmost non-zero number in a column remain zero, and zeros below the bottommost non-zero number also remain zero.

**Facts:**


```yaml
Task: Grid Transformation - Columnar Fill Down

Elements:
  - Object: Grid
    Properties:
      - rows: Integer (number of rows)
      - columns: Integer (number of columns)
      - cells: Matrix of Cell objects
  - Object: Cell
    Properties:
      - row: Integer (y-coordinate)
      - column: Integer (x-coordinate)
      - value: Integer (0-9)
  - Object: Column
    Properties:
      - index: Integer
      - cells: List of Cell objects in that column, ordered top-to-bottom
  - Object: Number
    Properties:
      - value: Integer (1-9, non-zero)
      - location: Cell

Relationships:
  - Vertical Adjacency: Cells within the same column can be above or below each other.
  - Containment: A Grid contains Columns; a Column contains Cells.

Actions:
  - Identify Non-Zero Cells: Find all cells within a column that have a value > 0.
  - Fill Downwards: For a given non-zero cell, change the value of zero cells directly below it in the same column.
  - Stop Filling: The downward fill stops when another non-zero cell is encountered in the same column or the grid boundary is reached.

Transformation Rule Summary:
  - Process each column independently.
  - Within a column, iterate from the top row downwards.
  - Keep track of the 'current fill value', initially null or zero.
  - When a non-zero cell is encountered, update the 'current fill value' to this cell's value.
  - If a cell is zero and the 'current fill value' is non-zero, change the cell's value to the 'current fill value'.
  - The output grid reflects these filled values.
```


**Natural Language Program:**

1.  Initialize the output grid as a copy of the input grid.
2.  Iterate through each column of the grid, from left to right (index `j` from 0 to `num_columns - 1`).
3.  For the current column `j`, initialize a variable `current_fill_value` to 0.
4.  Iterate through each row of the current column `j`, from top to bottom (index `i` from 0 to `num_rows - 1`).
5.  Examine the value of the cell at `(i, j)` in the *input* grid.
6.  If the input cell value at `(i, j)` is non-zero:
    *   Update `current_fill_value` to this non-zero value.
7.  Else (if the input cell value at `(i, j)` is zero):
    *   If `current_fill_value` is non-zero, set the value of the cell at `(i, j)` in the *output* grid to `current_fill_value`.
8.  After iterating through all rows in the column, proceed to the next column.
9.  Once all columns have been processed, the output grid contains the final transformed state.
```python
"""
Processes each column of the input grid independently. Within each column, iterates from top to bottom. When a non-zero number is encountered, it becomes the 'current fill value'. Subsequent zero cells below it in the same column are filled with this 'current fill value' until another non-zero number is found, which then becomes the new 'current fill value'. Zeros above the first non-zero number in a column remain zero.
"""

import copy

def transform(input_grid: list[list[int]]) -> list[list[int]]:
    """
    Fills zero cells downwards in each column with the value of the nearest non-zero cell above it.

    Args:
        input_grid: A list of lists representing the 2D grid of integers.

    Returns:
        A new list of lists representing the transformed grid.
    """
    # Handle empty input grid case
    if not input_grid or not input_grid[0]:
        return []

    # Get grid dimensions
    num_rows = len(input_grid)
    num_cols = len(input_grid[0])

    # Initialize output_grid as a deep copy to avoid modifying the original input
    output_grid = copy.deepcopy(input_grid)

    # Iterate through each column
    for j in range(num_cols):
        # Initialize the value to fill downwards for the current column
        current_fill_value = 0

        # Iterate through each row in the current column
        for i in range(num_rows):
            # Check the value in the original input grid
            if input_grid[i][j] != 0:
                # Update the fill value if a non-zero number is found
                current_fill_value = input_grid[i][j]
                # The output grid already has this non-zero value from the deepcopy
            else:
                # If the current cell is zero and we have a fill value
                if current_fill_value != 0:
                    # Fill the corresponding cell in the output grid
                    output_grid[i][j] = current_fill_value

    # Return the transformed grid
    return output_grid
```
