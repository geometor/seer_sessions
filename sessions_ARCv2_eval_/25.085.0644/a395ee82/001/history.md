
## train_1

**input:**
```
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 4 2 4 4 4 4 4 4 4
4 4 4 4 8 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 8 4 2 4 8 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 8 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 8 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
```


**output:**
```
4 4 4 4 4 4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 4 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 2 4 4 8 4 4 2 4 4 4 4 4
4 4 4 4 4 4 4 4 4 2 2 2 8 8 8 2 2 2 4 4 4 4
4 4 4 4 4 4 4 4 4 2 4 2 8 4 8 2 4 2 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 4 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 2 4 2 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
```


## train_2

**input:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 3 2 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```


**output:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3
3 3 3 1 1 3 1 1 3 1 1 3 3 3 3 3 3 3 3 3 3 3
3 3 1 1 3 1 1 3 1 1 3 3 3 3 3 3 3 3 3 3 3 3
3 3 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```


## train_3

**input:**
```
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 4 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 6 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 6 7 4 7 6 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 6 7 7 7 6 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
```


**output:**
```
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 4 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
4 4 7 6 6 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7
4 4 4 6 6 6 4 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7
7 4 4 7 6 6 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7
4 4 7 7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7 7
4 4 4 7 7 7 4 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7
7 4 4 7 7 7 7 4 4 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
```

Okay, let's analyze the task.

**Perception**

1.  **Background Color:** Each example pair features a dominant background color that remains consistent from input to output (Yellow 4 in train_1, Green 3 in train_2, Orange 7 in train_3).
2.  **Pattern Object:** In each input grid, there is one prominent, connected shape composed of a single color (Red 2 'T' in train_1, Blue 1 'cross' in train_2, Yellow 4 'L' in train_3). This shape appears to be the 'pattern' that gets replicated. Notably, this pattern object seems to be the largest connected component (excluding the background).
3.  **Marker Pixels:** There are other, smaller objects (often single pixels) of a different color (Azure 8 in train_1, Red 2 in train_2, Magenta 6 in train_3). These act as 'markers'. These marker pixels seem to correspond to the color of the smallest non-background object(s).
4.  **Transformation:** The core transformation involves copying the 'pattern' object. Copies of the pattern object are placed onto the output grid, centered at the locations where the 'marker' pixels existed in the input grid.
5.  **Persistence/Removal:** The original 'pattern' object also persists in its original location in the output. The 'marker' pixels themselves are removed (or overwritten) in the output. Any other pixels that are not part of the background or the identified pattern object are also removed and replaced with the background color.

**Facts**


```yaml
task_elements:
  - item: Grids
    properties:
      - type: 2D array of integers (0-9)
      - size: variable (up to 30x30)
      - background_color: dominant color, persists in output
  - item: Pattern Object
    properties:
      - type: connected group of pixels
      - color: specific color, differs from background and marker
      - identification: typically the largest connected non-background object
      - role: template shape to be copied
  - item: Marker Pixels
    properties:
      - type: small group(s) or single pixels
      - color: specific color, differs from background and pattern
      - identification: typically the color of the smallest non-background object(s)
      - role: target locations for copying the pattern
  - item: Other Pixels
    properties:
      - type: isolated pixels or small groups
      - color: potentially same as pattern or other colors
      - role: noise, removed in the output

actions:
  - action: Identify Background Color
    actor: system
    details: Find the most frequent pixel color in the input grid.
  - action: Identify Pattern Object
    actor: system
    details: Find the largest connected group of non-background pixels. Determine its shape, color, and original location.
  - action: Identify Marker Pixels
    actor: system
    details: Find all pixels matching the color of the smallest connected non-background object(s). Record their locations.
  - action: Initialize Output Grid
    actor: system
    details: Create a new grid of the same dimensions as the input, filled entirely with the background color.
  - action: Place Original Pattern
    actor: system
    target: Output Grid
    details: Copy the identified pattern object onto the output grid at its original input location.
  - action: Copy Pattern to Markers
    actor: system
    target: Output Grid
    details: For each identified marker pixel location, copy the pattern object onto the output grid, ensuring the center of the pattern aligns with the marker pixel's location. Overwrite existing pixels as needed.

relationships:
  - type: spatial
    entity1: Marker Pixel
    entity2: Copied Pattern Object
    details: The center of the copied pattern object is placed at the location of the marker pixel.
  - type: identity
    entity1: Input Background Color
    entity2: Output Background Color
    details: The background color remains unchanged.
  - type: transformation
    entity1: Marker Pixels
    entity2: Output Grid
    details: Marker pixels are removed or overwritten in the output.
  - type: transformation
    entity1: Other Pixels (Noise)
    entity2: Output Grid
    details: Pixels not belonging to the background, pattern, or markers are replaced by the background color.
```


**Natural Language Program**

1.  Determine the background color by finding the most frequent color in the input grid.
2.  Identify all connected objects (groups of same-colored, adjacent pixels) that are not the background color.
3.  Identify the 'pattern object' as the largest connected object found in step 2. Record its shape, color, and the coordinates of its bounding box relative to its top-left corner. Also, record the top-left corner's position in the input grid.
4.  Identify the 'marker color' as the color of the smallest connected object(s) found in step 2.
5.  Find the coordinates of all pixels in the input grid that have the 'marker color'. These are the 'marker locations'.
6.  Create a new output grid with the same dimensions as the input grid, filled entirely with the background color.
7.  Place the original 'pattern object' onto the output grid at its original top-left position.
8.  For each 'marker location' identified in step 5:
    a.  Calculate the center coordinates of the 'pattern object's' bounding box (e.g., `center_row = height // 2`, `center_col = width // 2`).
    b.  Determine the target top-left coordinate on the output grid for placing the pattern, such that the pattern's calculated center aligns with the current 'marker location'. The target top-left is `(marker_row - center_row, marker_col - center_col)`.
    c.  Copy the pixels forming the 'pattern object' onto the output grid, starting at the calculated target top-left coordinate. Overwrite any existing pixels in the output grid during this copy operation.
9.  The resulting grid is the final output.
