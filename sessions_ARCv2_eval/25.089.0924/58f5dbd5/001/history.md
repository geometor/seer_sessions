
## train_1

**input:**
```
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
8 4 4 4 8 8 3 8 3 8 8 8 8 1 1 1 1 1 8
8 4 8 4 8 8 8 3 3 8 8 8 8 1 1 1 1 1 8
8 4 8 4 8 8 3 8 8 8 8 8 8 1 1 1 1 1 8
8 8 8 8 8 8 8 8 8 8 8 8 8 1 1 1 1 1 8
8 1 1 1 8 8 8 8 8 8 8 8 8 1 1 1 1 1 8
8 8 1 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
8 1 1 1 8 8 8 8 8 8 8 8 8 6 6 6 6 6 8
8 8 8 8 8 8 8 8 8 8 8 8 8 6 6 6 6 6 8
8 8 8 8 8 8 8 8 8 8 8 8 8 6 6 6 6 6 8
8 9 9 9 8 8 8 8 8 8 8 8 8 6 6 6 6 6 8
8 9 8 9 8 8 8 8 8 8 8 8 8 6 6 6 6 6 8
8 8 9 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
8 8 8 8 8 8 8 8 8 8 8 8 8 4 4 4 4 4 8
8 8 8 8 8 8 8 8 8 8 8 8 8 4 4 4 4 4 8
8 6 8 6 8 8 5 5 8 8 8 8 8 4 4 4 4 4 8
8 6 6 8 8 8 8 5 5 8 8 8 8 4 4 4 4 4 8
8 6 8 8 8 8 5 8 5 8 8 8 8 4 4 4 4 4 8
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
```


**output:**
```
8 8 8 8 8 8 8
8 1 1 1 1 1 8
8 1 8 8 8 1 8
8 1 1 8 1 1 8
8 1 8 8 8 1 8
8 1 1 1 1 1 8
8 8 8 8 8 8 8
8 6 6 6 6 6 8
8 6 8 6 8 6 8
8 6 8 8 6 6 8
8 6 8 6 6 6 8
8 6 6 6 6 6 8
8 8 8 8 8 8 8
8 4 4 4 4 4 8
8 4 8 8 8 4 8
8 4 8 4 8 4 8
8 4 8 4 8 4 8
8 4 4 4 4 4 8
8 8 8 8 8 8 8
```


## train_2

**input:**
```
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 1 1 4 4 6 6 4 4 8 8 8 4 4 4 4 4 4 4
4 4 1 4 4 6 4 6 4 4 8 4 4 4 4 4 4 4 4
4 1 1 1 4 4 6 6 4 8 8 8 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 3 4 3 4 2 4 2 4 9 4 4 4 4 4 4 4 4 4
4 3 3 3 4 2 2 4 4 9 9 9 4 4 4 4 4 4 4
4 4 3 3 4 2 4 2 4 9 9 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
```


**output:**
```
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 1 4 4 1 1 4 2 4 2 4 2 4 3 4 3 4 3 4
4 1 1 4 1 1 4 2 4 4 2 2 4 3 4 4 4 3 4
4 1 4 4 4 1 4 2 4 2 4 2 4 3 3 4 4 3 4
4 1 1 1 1 1 4 2 2 2 2 2 4 3 3 3 3 3 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
```


## train_3

**input:**
```
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 8 8 8 8 8 1 4 4 4 4 4 1 1 1 2 2 2 1 7 1 7 1
1 8 8 8 8 8 1 4 4 4 4 4 1 1 1 2 1 1 1 1 7 1 1
1 8 8 8 8 8 1 4 4 4 4 4 1 1 1 1 2 2 1 1 7 1 1
1 8 8 8 8 8 1 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1
1 8 8 8 8 8 1 4 4 4 4 4 1 1 1 9 1 9 1 1 5 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 9 9 1 1 5 1 5 1
1 3 3 3 3 3 1 9 9 9 9 9 1 1 1 1 9 1 1 1 5 1 1
1 3 3 3 3 3 1 9 9 9 9 9 1 1 1 1 1 1 1 1 1 1 1
1 3 3 3 3 3 1 9 9 9 9 9 1 1 1 8 8 1 1 6 6 6 1
1 3 3 3 3 3 1 9 9 9 9 9 1 1 1 8 8 1 1 1 6 6 1
1 3 3 3 3 3 1 9 9 9 9 9 1 1 1 1 1 8 1 6 6 6 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 1 4 1 3 3 3 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 1 1 3 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 1 1 1 3 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```


**output:**
```
1 1 1 1 1 1 1 1 1 1 1 1 1
1 8 8 8 8 8 1 4 4 4 4 4 1
1 8 1 1 8 8 1 4 1 4 1 4 1
1 8 1 1 8 8 1 4 1 1 1 4 1
1 8 8 8 1 8 1 4 4 1 4 4 1
1 8 8 8 8 8 1 4 4 4 4 4 1
1 1 1 1 1 1 1 1 1 1 1 1 1
1 3 3 3 3 3 1 9 9 9 9 9 1
1 3 1 1 1 3 1 9 1 9 1 9 1
1 3 3 1 3 3 1 9 1 1 9 9 1
1 3 3 1 3 3 1 9 9 1 9 9 1
1 3 3 3 3 3 1 9 9 9 9 9 1
1 1 1 1 1 1 1 1 1 1 1 1 1
```

*   **Perception:** The task involves transforming an input grid containing various colored shapes on a background into an output grid. The output grid is a cropped section of the input grid, containing only specific shapes from the input, modified. The core transformation appears to be identifying solid 5x5 rectangular blocks of color, cropping the grid to contain these blocks plus a one-pixel border of the background color, and then "hollowing out" these 5x5 blocks by changing their inner 3x3 core to the background color, leaving only the frame.

*   **YAML:**
    
```yaml
    task_description: Identify solid 5x5 rectangles, crop the grid around them with a 1-pixel border, and hollow out the rectangles.

    elements:
      - element: grid
        description: A 2D array of pixels with integer values 0-9 representing colors.
      - element: background_pixel
        description: The pixel color that constitutes the majority of the grid or the frame/border pixels. It remains unchanged in the output grid's background areas.
      - element: object
        description: A contiguous region of non-background pixels.
      - element: target_object
        properties:
          - shape: rectangle
          - size: 5x5 pixels
          - fill: solid (no background pixels inside)
        description: A specific type of object identified in the input grid. These are the only objects processed and preserved (in modified form) in the output.
      - element: hollowed_object
        description: The transformed version of a target_object in the output grid. It retains the original color and 5x5 dimensions but has its inner 3x3 pixels replaced with the background color, forming a frame.
      - element: bounding_box
        description: The smallest rectangle enclosing all identified target_objects.
      - element: output_subgrid
        description: A subgrid extracted from the input grid based on the bounding_box expanded by one pixel in each direction. This forms the basis of the output grid.

    actions:
      - action: identify_background
        description: Determine the background color of the input grid.
      - action: find_objects
        description: Locate all contiguous regions of non-background pixels in the input grid.
      - action: filter_objects
        description: Select only the objects that are solid 5x5 rectangles (target_objects).
      - action: calculate_bounding_box
        description: Determine the minimum and maximum row and column indices covering all target_objects.
      - action: calculate_output_dimensions
        description: Expand the bounding_box by 1 pixel in all directions (top, bottom, left, right), clamped to the input grid boundaries, to define the area for the output subgrid.
      - action: extract_subgrid
        description: Copy the pixels from the input grid corresponding to the calculated output dimensions.
      - action: hollow_out_rectangles
        description: For each target_object identified in the input, locate its corresponding position in the extracted subgrid and replace its inner 3x3 pixels with the background color.

    relationships:
      - relationship: object_selection
        description: Only solid 5x5 rectangles (target_objects) from the input are relevant to the output. Other shapes or non-solid rectangles are ignored.
      - relationship: cropping
        description: The output grid dimensions are determined by the spatial extent of the selected target_objects plus a 1-pixel border.
      - relationship: modification
        description: Selected target_objects are modified by hollowing out their centers. Their positions relative to each other and the background frame are preserved in the output subgrid.
      - relationship: color_preservation
        description: The background color and the colors of the frames of the hollowed_objects in the output are the same as their corresponding colors in the input.
    ```


*   **Natural Language Program:**
    1.  Determine the background color of the input grid (this is typically the most frequent color or the color forming the outer border).
    2.  Identify all contiguous regions (objects) of non-background colors in the input grid.
    3.  Filter these objects, keeping only those that are perfectly solid (contain no background pixels) 5x5 rectangles. Let these be the "target rectangles".
    4.  Find the minimum bounding box that encompasses all identified target rectangles. Get the minimum row (`min_r`), maximum row (`max_r`), minimum column (`min_c`), and maximum column (`max_c`) coordinates covered by these rectangles.
    5.  Define the region for the output grid by expanding this bounding box by one pixel in each direction: from `row = max(0, min_r - 1)` to `row = min(input_height - 1, max_r + 1)` and from `col = max(0, min_c - 1)` to `col = min(input_width - 1, max_c + 1)`.
    6.  Create the output grid by copying the pixels from the input grid within this calculated expanded region.
    7.  For each target rectangle originally located at `(r, c)` to `(r+4, c+4)` in the input grid:
        a.  Calculate its corresponding top-left starting position `(out_r, out_c)` within the output grid. `out_r = r - max(0, min_r - 1)` and `out_c = c - max(0, min_c - 1)`.
        b.  Modify the output grid by changing the color of the pixels in the 3x3 area from `(out_r + 1, out_c + 1)` to `(out_r + 3, out_c + 3)` to the background color identified in step 1.
