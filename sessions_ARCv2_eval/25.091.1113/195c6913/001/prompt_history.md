
## train_1

**input:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 0
3 2 2 3 2 2 3 8 8 3 3 3 3 3 3 3 0 0 0 0
3 2 2 3 2 2 3 8 8 3 3 3 3 3 3 3 0 0 0 0
3 3 3 3 3 3 3 3 3 3 3 3 3 3 0 0 0 0 0 3
3 3 3 3 3 3 3 3 3 3 3 3 0 0 0 0 0 0 3 3
3 3 3 3 3 3 3 3 3 0 0 0 0 0 0 0 0 3 3 3
3 3 3 3 3 3 3 0 0 0 0 0 0 0 0 0 3 3 3 3
3 3 3 3 3 0 0 0 0 0 0 0 0 0 0 0 3 3 3 3
3 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 3 3
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 3 3 3 3
0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3
2 0 0 0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3
0 0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 4 4 3 3
0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 4 4 3 3
0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3 3 3
0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3 3 3 3
```


**output:**
```
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 0
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 0 2 8 2
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 0 2 0 0
3 3 3 3 3 3 3 3 3 3 3 3 4 3 0 0 0 8 0 3
3 3 3 3 3 3 3 3 3 3 3 3 8 2 2 8 2 2 4 3
3 3 3 3 3 3 3 3 3 0 0 0 2 0 0 0 0 3 3 3
3 3 3 3 3 3 3 0 0 0 0 0 2 0 0 0 3 3 3 3
3 3 3 3 3 0 0 0 0 0 0 0 8 0 0 0 3 3 3 3
3 3 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 8 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 3
0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 3 3 3
0 0 0 0 0 0 0 0 0 0 0 0 8 0 0 3 3 3 3 3
0 0 0 0 0 0 0 0 0 0 0 0 2 0 3 3 3 3 3 3
2 2 8 2 2 8 2 2 8 2 2 8 2 4 3 3 3 3 3 3
0 0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3
0 0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3 3
0 0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3 3 3
0 0 0 0 0 0 0 0 3 3 3 3 3 3 3 3 3 3 3 3
```


## train_2

**input:**
```
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8
2 4 4 2 1 1 2 2 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8
2 4 4 2 1 1 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 2 2
2 2 2 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 2 2
2 2 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2
2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2
2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2
2 2 2 8 2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2
4 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2
2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 8 8 2 2 2 2 2 2 2
2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2 2
2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2 2 2
2 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 9 9 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 9 9 2 2
4 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
```


**output:**
```
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 8 8 8 1 8 8 8 8
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 8 8 8 4 8 8 8 8
2 2 2 2 2 2 2 2 2 2 2 2 2 2 9 8 8 8 8 8 1 8 8 2 2
2 2 2 2 2 2 2 2 2 2 2 2 8 8 4 1 4 1 4 1 4 9 2 2 2
2 2 2 2 2 2 2 2 2 2 2 8 8 8 1 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 2 2 2 2 2 8 8 8 8 4 8 8 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 8 8 8 8 8 1 8 8 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 8 8 8 8 8 4 8 8 8 8 8 8 8 2 2 2
2 2 2 2 2 2 2 8 8 8 8 8 8 8 1 8 8 8 8 8 8 8 2 2 2
2 2 2 2 2 2 2 8 8 8 8 8 8 8 4 8 8 8 8 8 8 8 8 8 2
2 2 2 8 2 8 8 8 8 8 8 8 8 8 1 8 8 8 8 8 8 8 8 8 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 4 2 2 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 1 2 2 2 2 2 2 2 2 2 2
4 1 4 1 4 1 4 1 4 1 4 1 4 1 4 9 2 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2
2 2 2 2 2 2 2 2 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2
2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 8 8 2 2 2 2 2 2 2
2 2 2 2 2 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2 2
2 2 2 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2 2 2
2 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2 2
4 1 4 1 4 1 4 1 4 1 4 1 4 1 4 1 4 9 2 2 2 2 2 2 2
8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 2 2 2 2 2 2 2 2
```


## train_3

**input:**
```
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 2 2 1 2 2 1 3 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 2 2 1 2 2 1 3 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 1 4 4 4 4 4 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4
1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 4 4 4
1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 4 4 4
1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 4 4 4 4 4 1
2 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 1
4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 1
4 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 1 1
1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 1 1
1 1 1 1 1 4 4 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 1 1 1
1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 8 8 1
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 4 1 1 4 1 8 8 1
2 4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```


**output:**
```
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 8 1 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 2 3 2 2 3
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 2 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 3 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 2 4 4 4 4
1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 1 4 4 4 4 2 4 4 4 4
1 1 1 1 1 1 1 1 8 1 1 1 4 4 4 4 4 4 4 4 3 4 4 4 4
1 1 1 1 1 1 4 4 2 3 2 2 3 2 2 3 2 2 3 2 2 8 4 4 4
1 1 1 4 4 4 4 4 2 4 4 4 4 4 4 4 4 4 4 4 1 1 4 4 4
1 4 4 4 4 4 4 4 3 4 4 4 4 4 4 4 4 4 1 1 8 4 4 4 4
4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 4 4 1 1 1 2 2 3 2 2
4 4 4 4 4 4 4 4 2 4 4 4 4 1 1 1 1 1 1 4 3 4 4 4 1
2 2 3 2 2 3 2 2 3 8 1 1 1 1 1 1 1 1 1 1 2 4 4 4 1
4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 4 4 4 2 4 4 4 1
4 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 3 4 4 1 1
1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 2 4 4 1 1
1 1 1 1 1 4 4 1 1 8 1 4 4 4 4 4 4 4 4 4 2 4 1 1 1
1 4 4 4 4 4 4 4 4 2 2 3 2 2 3 2 2 3 2 2 3 8 1 1 1
4 4 4 4 4 4 4 4 4 3 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1
4 4 4 4 4 4 4 4 4 2 4 4 4 4 4 4 1 4 1 1 4 1 1 1 1
2 2 3 2 2 3 2 2 3 2 8 1 1 1 1 1 1 1 1 1 1 1 1 1 1
4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

Okay, let's break down the task based on the provided examples.

## Perception

1.  **Grid Structure:** Both input and output are 2D grids of colored pixels. The dimensions of the output grid are identical to the input grid.
2.  **Color Roles:** In each example, different colors seem to play distinct roles:
    *   **Background:** A color that occupies a large area, often framing the grid or filling space where no specific action occurs. This color generally remains unchanged. (e.g., Green-3 in Ex1, Red-2 in Ex2, Blue-1 in Ex3).
    *   **Fillable Area:** A region of a specific color in the input grid that gets overwritten by a pattern in the output grid. (e.g., White-0 in Ex1, Azure-8 in Ex2, Yellow-4 in Ex3).
    *   **Seed/Source:** One or more colors whose pixel locations in the input act as starting points or sources for the pattern fill. (e.g., Red-2/Azure-8 in Ex1, Yellow-4 in Ex2, Red-2/Green-3 in Ex3).
    *   **Terminator:** A color that halts the pattern propagation. Pixels with this color in the input retain their color in the output and act as boundaries for the fill. (e.g., Yellow-4 in Ex1, Maroon-9 in Ex2, Azure-8 in Ex3).
    *   **Erased:** Some colors present in the input might be simply replaced by the background color in the output if they aren't seeds, terminators, or fillable areas. (e.g., Blue-1 in Ex2).
    *   **Pattern Colors:** The specific sequence of colors used to fill the "Fillable Area". This sequence is consistent within each example. (e.g., (Red-2, Red-2, Azure-8) in Ex1, (Yellow-4, Blue-1) in Ex2, (Red-2, Red-2, Green-3) in Ex3).
3.  **Transformation:** The core transformation seems to be a "pattern fill" operation. A specific sequence of colors propagates (like mold or crystal growth) from the seed/source pixels into the adjacent fillable areas.
4.  **Propagation Mechanics:**
    *   The fill spreads using 8-directional adjacency (including diagonals).
    *   The pattern sequence repeats cyclically.
    *   The fill stops when it hits the grid boundary, a background pixel, a terminator pixel, or a pixel that has already been filled.
    *   The original seed pixels might retain their color, be replaced by the first color of the pattern, or remain unchanged depending on the specific example's rules. Terminator pixels always seem to retain their color. Erased pixels are replaced by the background color *before* the fill starts.

## Facts (YAML)


```yaml
task_type: pattern_fill
common_elements:
  - background_color: Persists from input to output, often the most frequent color or frames the grid.
  - fillable_color: Color of the area in the input that gets replaced by the pattern.
  - pattern_sequence: A repeating sequence of colors used for filling.
  - seed_colors: Pixels of these colors initiate the fill into adjacent fillable areas.
  - terminator_colors: Pixels of these colors halt the fill and retain their color.
  - erased_colors: (Optional) Pixels of these colors are replaced by the background color.
  - adjacency: 8-directional (includes diagonals).

example_specifics:
  - example: train_1
    background_color: 3 # green
    fillable_color: 0 # white
    seed_colors: [2, 8] # red, azure
    terminator_colors: [4] # yellow
    erased_colors: []
    pattern_sequence: [2, 2, 8] # red, red, azure
    seed_handling: Retain original color (2 or 8).
    terminator_handling: Retain original color (4).
    fill_start_color: 2 # First element of sequence.
  - example: train_2
    background_color: 2 # red
    fillable_color: 8 # azure
    seed_colors: [4] # yellow
    terminator_colors: [9] # maroon
    erased_colors: [1] # blue
    pattern_sequence: [4, 1] # yellow, blue
    seed_handling: Retain original color (4).
    terminator_handling: Retain original color (9).
    erased_handling: Replace with background color (2).
    fill_start_color: 4 # First element of sequence.
  - example: train_3
    background_color: 1 # blue
    fillable_color: 4 # yellow
    seed_colors: [2, 3] # red, green
    terminator_colors: [8] # azure
    erased_colors: []
    pattern_sequence: [2, 2, 3] # red, red, green
    seed_handling: Replace with pattern start color (2).
    terminator_handling: Retain original color (8).
    fill_start_color: 2 # First element of sequence.

transformation_process:
  - step: Initialize output grid by copying the input grid.
  - step: Identify the roles of each color (Background, Fillable, Seed, Terminator, Erased).
  - step: (If applicable) Replace all pixels with Erased colors with the Background color in the output grid.
  - step: (If applicable) Modify the color of Seed pixels in the output grid according to example-specific rules.
  - step: Identify all Fillable pixels in the *input* grid that are 8-directionally adjacent to Seed pixels in the *input* grid. These are the initial fill locations.
  - step: Use a Breadth-First Search (BFS) or similar propagation method starting from these initial fill locations.
  - step: Maintain a `visited` set to track filled pixels.
  - step: For the initial fill locations not already visited, set their color in the output grid to the first color of the `pattern_sequence`, mark as visited, and add to the BFS queue.
  - step: While the BFS queue is not empty:
      - Dequeue a pixel `(r, c)`.
      - Determine the next color in the `pattern_sequence` based on the color of `output[r][c]`.
      - For each 8-directional neighbor `(nr, nc)`:
          - If `(nr, nc)` is within grid bounds AND the color `input[nr][nc]` is the Fillable color AND `(nr, nc)` is not in the `visited` set:
              - Set `output[nr][nc]` to the determined next pattern color.
              - Add `(nr, nc)` to the `visited` set.
              - Enqueue `(nr, nc)`.
  - step: Ensure Background and Terminator pixels retain their original colors throughout the process.
```


## Natural Language Program

1.  **Analyze** the input grid to identify the distinct roles of colors present: determine the Background color, the Fillable color (the area to be patterned), the Seed color(s) (initiators of the pattern), the Terminator color(s) (boundaries for the pattern), and any Erased color(s) (to be removed). Also, determine the repeating Pattern Sequence.
2.  **Initialize** an output grid as a copy of the input grid.
3.  **Pre-process** the output grid:
    *   Replace any pixels matching Erased colors with the Background color.
    *   Modify the Seed pixels in the output grid based on the specific rule for the task (e.g., keep original color, replace with pattern start color).
4.  **Identify starting points** for the fill: find all pixels in the input grid that have the Fillable color and are 8-directionally adjacent to any pixel that had a Seed color in the original input grid.
5.  **Perform a pattern fill** (using a method like Breadth-First Search):
    *   Create a queue for the BFS and a set to track visited Fillable pixels.
    *   For each identified starting point pixel: if it hasn't been visited, set its color in the output grid to the first color in the Pattern Sequence, mark it as visited, and add it to the queue.
    *   While the queue is not empty:
        *   Get the next pixel `P` from the queue.
        *   Determine the `Next_Pattern_Color` based on the current color of `P` in the output grid and the fixed Pattern Sequence.
        *   Examine all 8 neighbors `N` of `P`.
        *   If a neighbor `N` is within the grid boundaries, had the Fillable color in the original input, and has not been visited:
            *   Set the color of `N` in the output grid to `Next_Pattern_Color`.
            *   Mark `N` as visited.
            *   Add `N` to the queue.
6.  **Return** the modified output grid. The fill naturally stops at grid edges, Background pixels, Terminator pixels (which were never Fillable), and already visited pixels.
